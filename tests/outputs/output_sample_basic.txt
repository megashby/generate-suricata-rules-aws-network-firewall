alert tls $HOME_NET any -> $EXTERNAL_NET any (flow:to_server; msg:"DROP traffic for evil.com via TLS (logged)"; tls.sni; dotprefix; content:"evil.com"; endswith; nocase; sid:1;)
drop tls $HOME_NET any -> $EXTERNAL_NET any (flow:to_server; tls.sni; dotprefix; content:"evil.com"; endswith; nocase; sid:2;)
alert http $HOME_NET any -> $EXTERNAL_NET any (flow:to_server; msg:"DROP traffic for evil.com via HTTP (logged)"; http.host; dotprefix; content:"evil.com"; endswith; sid:3;)
drop http $HOME_NET any -> $EXTERNAL_NET any (flow:to_server; http.host; dotprefix; content:"evil.com"; endswith; sid:4;)
alert tls $HOME_NET any -> $EXTERNAL_NET any (flow:to_server; msg:"DROP traffic for nice.com via TLS (logged)"; tls.sni; content:"evil.nice.com"; startswith; endswith; nocase; sid:5;)
drop tls $HOME_NET any -> $EXTERNAL_NET any (flow:to_server; tls.sni; content:"evil.nice.com"; startswith; endswith; nocase; sid:6;)
alert tls $HOME_NET any -> $EXTERNAL_NET any (flow:to_server; msg:"DROP traffic for nice.com via TLS (logged)"; tls.sni; content:"bad.nice.com"; startswith; endswith; nocase; sid:7;)
drop tls $HOME_NET any -> $EXTERNAL_NET any (flow:to_server; tls.sni; content:"bad.nice.com"; startswith; endswith; nocase; sid:8;)
pass http $HOME_NET any -> $EXTERNAL_NET any (flow:to_server; http.host; content:"test.org"; startswith; endswith; sid:9;)
alert tls $HOME_NET any -> $EXTERNAL_NET any (flow:to_server; msg:"DROP traffic for test.com via TLS (logged)"; tls.sni; content:"badsubdomain.test.com"; startswith; endswith; nocase; sid:10;)
drop tls $HOME_NET any -> $EXTERNAL_NET any (flow:to_server; tls.sni; content:"badsubdomain.test.com"; startswith; endswith; nocase; sid:11;)
pass tls $HOME_NET any -> $EXTERNAL_NET any (flow:to_server; tls.sni; pcre:"/^[^.]+\.(?:[^.]+\.)*test\.com$/i"; sid:12;)